{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <title>Sliding Systems - SUBASH BUILD AND DESIGN</title>
  <link rel="stylesheet" href="{% static 'fontawesome-5.5/css/all.min.css' %}" />
  <link rel="stylesheet" href="{% static 'slick/slick.css' %}">
  <link rel="stylesheet" href="{% static 'slick/slick-theme.css' %}">
  <link rel="stylesheet" href="{% static 'magnific-popup/magnific-popup.css' %}">
  <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}" />
  <link rel="stylesheet" href="{% static 'css/tooplate-infinite-loop.css' %}" />
</head>
<body>
  <section id="infinite" class="text-white tm-font-big tm-parallax">
    <nav class="navbar navbar-expand-md tm-navbar" id="tmNav">
      <div class="container">
        <div class="tm-next">
          <a href="{% url 'index' %}" class="navbar-brand">SUBASH BUILD AND DESIGN</a>
        </div>

        <button class="navbar-toggler" type="button" data-toggle="collapse" 
                data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" 
                aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item"><a class="nav-link tm-nav-link" href="{% url 'index' %}">Home</a></li>
            <li class="nav-item dropdown">
              <a class="nav-link tm-nav-link dropdown-toggle" href="#" id="navbarDropdown"
                 role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                What We Do
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="{% url 'interior' %}">Interior Design</a>
                <a class="dropdown-item" href="{% url 'sliding' %}">Sliding Systems</a>
                <a class="dropdown-item" href="{% url 'construction' %}">Construction</a>
              </div>
            </li>
            <li class="nav-item"><a class="nav-link tm-nav-link" href="{% url 'index' %}#testimonials">Testimonials</a></li>
            <li class="nav-item"><a class="nav-link tm-nav-link" href="#gallery">Gallery</a></li>
            <li class="nav-item"><a class="nav-link tm-nav-link" href="#contact">Contact</a></li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="text-center tm-hero-text-container">
      <div class="tm-hero-text-container-inner">
        <h2 class="tm-hero-title">Sliding Systems</h2>
        <p class="tm-hero-subtitle">Space-Saving • Stylish • Functional</p>
      </div>
    </div>
  </section>

  <section id="gallery" class="tm-section-pad-top">
    <div class="container tm-container-gallery">
      <div class="row">
        <div class="text-center col-12">
          <h2 class="tm-text-primary tm-section-title mb-4">Our Sliding Projects</h2>
          <p class="mx-auto tm-section-desc">
            Discover our premium sliding solutions, including wardrobe doors, partitions, and customized space-saving systems. Every project is crafted with durability and modern style in mind.
          </p>
        </div>
      </div>
      <div class="row">
        <div class="col-12">
          <div class="mx-auto tm-gallery-container">
            <div class="grid tm-gallery">

              {% for image in gallery_images %}
              <a href="{{ image.image.url }}" class="tm-gallery-item">
                <figure class="effect-honey">
                  <img src="{{ image.image.url }}" alt="{{ image.title }}" class="img-fluid">
                  <figcaption><h2><i>{{ image.title }}</i></h2></figcaption>
                </figure>
              </a>
              {% empty %}
              <p class="text-center">No sliding images available yet.</p>
              {% endfor %}

            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section id="contact" class="tm-section-pad-top tm-parallax-2">
    <div class="container tm-container-contact">
      <div class="row">
        <div class="text-center col-12">
          <h2 class="tm-section-title mb-4">Contact Us</h2>
          <p class="mb-5">We'd love to hear about your sliding system needs. Get in touch today!</p><br>
        </div>
        <div class="col-sm-12 col-md-6">
          <form action="{% url 'contact' %}" method="POST">
            {% csrf_token %}
            <input id="name" name="name" type="text" placeholder="Your Name" class="tm-input" required />
            <input id="email" name="email" type="email" placeholder="Your Email" class="tm-input" required />
            <textarea id="message" name="message" rows="8" placeholder="Message" class="tm-input" required></textarea>
            <button type="submit" class="btn tm-btn-submit">Submit</button>
          </form>
        </div>
        <div class="col-sm-12 col-md-6">
          <div class="contact-item">
            <a href="mailto:subashbuildanddesignstudio@gmail.com" class="item-link">
              <i class="far fa-2x fa-envelope mr-4"></i>
              <span>subashbuildanddesignstudio@gmail.com</span>
            </a>
          </div>
          <div class="contact-item">
            <a href="" class="item-link">
              <i class="fas fa-2x fa-map-marker-alt mr-4"></i>
              <span>1/15, 17th Street, B-Sector, Siva Sakthi Nagar, Annanur, Chennai-600062</span>
            </a>
          </div>
          <div class="contact-item">
            <a href="tel:7550180554" class="item-link">
              <i class="fas fa-2x fa-phone-square mr-4"></i>
              <span>7550180554</span>
            </a>
          </div>
          <div class="contact-item">
            <a href="https://wa.me/917550180554" target="_blank" class="item-link">
              <i class="fab fa-2x fa-whatsapp mr-4"></i>
              <span>7550180554</span>
            </a>
          </div>
          <div class="contact-item">
            <a href="" target="_blank" class="item-link">
              <i class="fab fa-2x fa-instagram mr-4"></i>
              <span>  </span>
            </a>
          </div>
        </div>
      </div>
    </div>
    <footer class="text-center small tm-footer">
      <p class="mb-0">
        Copyright &copy; 2025 SUBASH BUILD AND DESIGN 
        . <a rel="nofollow" href="#">Designed by upmtechnologies</a>
      </p>
    </footer>
  </section>

  <script src="{% static 'js/jquery-1.9.1.min.js' %}"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
  <script src="{% static 'js/bootstrap.min.js' %}"></script>
  <script src="{% static 'slick/slick.min.js' %}"></script>
  <script src="{% static 'magnific-popup/jquery.magnific-popup.min.js' %}"></script>
  <script src="{% static 'js/easing.min.js' %}"></script>
  <script src="{% static 'js/jquery.singlePageNav.min.js' %}"></script>

  <script>
    $(function(){
      // Close mobile menu after click 
      $('#tmNav a').on('click', function(){
        // Don't close if it's a dropdown toggle
        if(!$(this).hasClass('dropdown-toggle')) {
          $('.navbar-collapse').removeClass('show'); 
        }
      });

      // Handle dropdown item clicks - allow navigation
      $('.dropdown-item').on('click', function(e){
        e.stopPropagation();
        $('.navbar-collapse').removeClass('show');
      });

      // Navbar scroll effect
      $(window).scroll(function(){          
        if($(document).scrollTop() > 120) {
          $('.tm-navbar').addClass("scroll");
        } else {
          $('.tm-navbar').removeClass("scroll");
        }
      });

      // Auto-Close Mobile Menu and Dropdown on Link Click (Optimized Logic)
    var $navbarCollapse = $('#navbarSupportedContent');

    // 1. Handle regular nav links (Home, Testimonials, Gallery, Contact)
    $('#tmNav a.nav-link:not(.dropdown-toggle)').on('click', function(){
      $navbarCollapse.removeClass('show'); 
    });

    // 2. Handle Dropdown item clicks (Interior, Sliding, Construction)
    $('.dropdown-item').on('click', function(e) {
      $navbarCollapse.removeClass('show');
    });
    
      // Magnific Popup
      $('.tm-gallery').magnificPopup({
        delegate: 'a',
        type: 'image',
        gallery: { enabled: true }
      });

      // Gallery carousel 
      $('.tm-gallery').slick({
        dots: false,
        arrows: true,
        infinite: true,
        slidesToShow: 5,
        slidesToScroll: 2,
        responsive: [
          { breakpoint: 1199, settings: { slidesToShow: 4, slidesToScroll: 2 } },
          { breakpoint: 991, settings: { slidesToShow: 3, slidesToScroll: 2 } },
          { breakpoint: 767, settings: { slidesToShow: 2, slidesToScroll: 1, arrows: false } }, 
          { breakpoint: 480, settings: { slidesToShow: 1, slidesToScroll: 1, arrows: false } }   
        ]
      });
      // FIX: Force recalculation immediately
      $('.tm-gallery').slick('setPosition');
    });

    // FINAL FALLBACK FIX: Recalculate on window load to ensure images are fully rendered.
    $(window).on('load', function() {
        $('.tm-gallery').slick('setPosition');
    });


    // Gallery carousel 
    $('.tm-gallery').slick({
      dots: false, arrows: true, infinite: true, slidesToShow: 5, slidesToScroll: 2,
      responsive: [
        { breakpoint: 1199, settings: { slidesToShow: 4, slidesToScroll: 2 } },
        { breakpoint: 991, settings: { slidesToShow: 3, slidesToScroll: 2 } },
        { breakpoint: 767, settings: { slidesToShow: 2, slidesToScroll: 1, arrows: false } }, 
        { breakpoint: 480, settings: { slidesToShow: 1, slidesToScroll: 1, arrows: false } }   
      ]
    });

    // CRITICAL FINAL FIX: Force position refresh on window load and with a small delay
    $(window).on('load', function() {
        $('.tm-gallery').slick('setPosition');
    });
    setTimeout(function() {
        $('.tm-gallery').slick('setPosition');
    }, 100); 

  </script>
</body>
</html>